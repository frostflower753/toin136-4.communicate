<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>桐陰祭136-4</title>
  <style>
    * { box-sizing: border-box; }
    html, body { margin: 0; padding: 0; height: 100%; width: 100%; font-family: sans-serif; }
    body {
      background-image: url('宇宙.png');
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center center;
      background-color: #000;
      color: #a8ff60;
      display: flex; justify-content: center; align-items: center;
      position: relative;
    }
    body::before {
      content: "";
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.65); z-index: 0;
    }
    .container {
      position: relative; z-index: 1;
      max-width: 600px; width: 90%; padding: 40px 30px; border-radius: 12px; text-align: center;
    }
    h1 { font-size: 2.5rem; margin-bottom: 30px; text-shadow: 0 0 8px #a8ff60; }
    p { font-size: 1.5rem; margin: 20px 0; text-shadow: 0 0 6px #a8ff60; }
    input {
      font-size: 1.2rem; padding: 12px; width: 80%; max-width: 400px; margin-top: 20px;
      border: 2px solid #a8ff60; background-color: rgba(18, 26, 0, 0.7);
      color: #a8ff60; border-radius: 6px; outline: none;
    }
    input:focus { border-color: #d4ff8c; background-color: rgba(33, 48, 0, 0.85); }
    button {
      font-size: 1.2rem; padding: 12px 24px; margin-top: 30px; cursor: pointer;
      background-color: rgba(34, 68, 0, 0.8); border: 2px solid #a8ff60; color: #a8ff60; border-radius: 8px;
    }
    button:hover { background-color: #3eb800; color: #000; border-color: #3eb800; }
    #incorrect-screen, #correct-screen { display: none; }

    .slide {
      display: none;
      border: 2px dashed #a8ff60;
      padding: 40px;
      border-radius: 8px;
    }
    .page-counter { margin-top: 15px; font-size: 1rem; color: #a8ff60a0; }
  </style>
</head>
<body>

<!-- クイズ画面 -->
<div class="container" id="quiz-screen">
  <h1>答えを入力してください</h1>
  <input type="text" id="answer" placeholder="ここに入力" autocomplete="off" onkeydown="handleKey(event)" />
  <button onclick="checkAnswer()">送信</button>
</div>

<!-- 正解画面（図鑑形式） -->
<div class="container" id="correct-screen">
  <h1>通信記録</h1>
  <div id="slides">
    <div class="slide">
      <h1>YY月9日 <br>from:The Ship</h1>
      <p>惑星tf-136に着陸。予想されていた通り、
我々の星とはまったく違う環境でした。<br>船員の健康状態は良好です。</p>
    </div>
      
    <div class="slide">
      <h1>from:Control Room</h1>
      <p>了解した。<br>引き続き惑星の探索を続けてくれ。
</p>
    </div>
      
    <div class="slide">
      <h1>YY月12日 <br>from:The Ship</h1>
      <p>惑星tf-136にて、とても異質な性質を持つ生物を捕獲しました。
我々の星では見ない、驚異的な再生能力をもっています。
帰還までの時間で研究を進めたいと思います。</p>
    </div>
    <!-- 生物4 -->
    <div class="slide">
      <h1>YY月13日<br> from:Controle Room</h1>
      <p>驚異的な再生能力か。もしかしたら、それを利用すれば例の感染病の流行を食い止めることが
可能かもしれない。もしそうだとしたら、君たちは歴史に
残る大発見をしたことになる。早急な分析を頼む。</p>
    </div>
    <!-- 白紙スライド 6枚 -->
    <div class="slide">
        <h1>YY月17日 <br>from:Control Room</h1>
        <p>感染症が段々と勢力を増している。
この勢いを止められるがどうかは君たちにかかっている。
生命体の安全性テストは飛ばし本格的な実験に入ってほしい。</p></div>
    <div class="slide">
        <h1>YY月21日 <br>from:The Ship</h1>
        <p>生命体への実験をようやく開始しました。例の感染症自体には適応できたようです。しかし、それを人間に応用するには実験が足りないところもあります。引き続き実験を行う予定です。</p></div>
    <div class="slide">
        <h1>YY月24日 <br>from:The Ship</h1>
        <p>生命体に対する実験の結果、急激に身体が膨張してしまいました。これまで通りの研究ができない可能性があり、その場合、我々は歴史に残る大発見を潰してしまったことになります。</p></div>
  </div>
  <p class="page-counter" id="page-counter">1 / 7</p>
  <p style="font-size:0.9rem; color:#a8ff60a0;">← → キーでページ移動</p>
  <button onclick="location.reload()">戻る</button>
  <p style="font-size:0.9rem; color:#a8ff60a0;">※スペースキーでも戻れます</p>
</div>

<!-- 不正解画面 -->
<div class="container" id="incorrect-screen">
  <h1>ERROR</h1>
  <p>答えが異なります。<br>あと <span id="countdown">3</span> 秒で自動で戻ります。</p>
</div>

<script>
let countdownInterval = null;
let currentSlide = 0;

function handleKey(event) {
  if (event.key === "Enter") {
    if (document.getElementById('incorrect-screen').style.display === 'block') {
      event.preventDefault();
      return;
    }
    checkAnswer();
  }
}

// 正解画面の操作
document.addEventListener('keydown', function(event) {
  if (document.getElementById('correct-screen').style.display === 'block') {
    if (event.code === 'Space') {
      event.preventDefault();
      location.reload();
    }
    const slides = document.querySelectorAll('.slide');
    if (event.key === "ArrowRight" && currentSlide < slides.length - 1) {
      showSlide(currentSlide + 1);
    } else if (event.key === "ArrowLeft" && currentSlide > 0) {
      showSlide(currentSlide - 1);
    }
  }

  if (document.getElementById('incorrect-screen').style.display === 'block') {
    if (event.code === 'Enter' || event.code === 'Space') {
      event.preventDefault();
    }
  }
});

function checkAnswer() {
  const userAnswer = document.getElementById("answer").value.trim().toLowerCase();
  document.getElementById("quiz-screen").style.display = "none";
  if (countdownInterval) clearInterval(countdownInterval);

  if (["sh1p0104"].includes(userAnswer)) {
    document.getElementById("correct-screen").style.display = "block";
    showSlide(0);
  } else {
    document.getElementById("incorrect-screen").style.display = "block";
    startCountdown(3);
  }
}

function goBack() {
  if (countdownInterval) clearInterval(countdownInterval);
  document.getElementById("incorrect-screen").style.display = "none";
  document.getElementById("quiz-screen").style.display = "block";
  const input = document.getElementById("answer");
  input.value = "";
  input.focus();
}

function startCountdown(seconds) {
  const countdownElem = document.getElementById("countdown");
  let remaining = seconds;
  countdownElem.textContent = remaining;
  countdownInterval = setInterval(() => {
    remaining--;
    countdownElem.textContent = remaining;
    if (remaining <= 0) {
      clearInterval(countdownInterval);
      countdownInterval = null;
      goBack();
    }
  }, 1000);
}

function showSlide(index) {
  const slides = document.querySelectorAll('.slide');
  if (index < 0 || index >= slides.length) return;
  slides.forEach((s, i) => s.style.display = (i === index ? 'block' : 'none'));
  currentSlide = index;
  document.getElementById("page-counter").textContent = (index + 1) + " / " + slides.length;
}
</script>

</body>
</html>
